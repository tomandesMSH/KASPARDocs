<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>KASPAR Documentation</title>
  <link rel="icon" type="image/x-icon" href="files/kaspardocs.png">
  <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="top-navbar">
    <div class="nav-left">
      <a href="index.html"><img src="files/kasparlogo.png" alt="Logo"></a>
    </div>
    <nav class="nav-right">
      <a href="index.html">Home</a>
      <a href="scripts.html">Scripts</a>
      <a href="foundbugs.html">Windows Bugs</a>
      <a href="https://github.com/tomandesMSH">GitHub</a>
      <a href="bug.html">Report a bug</a>
    </nav>
  </header>

  <aside>
    <br><br>
    <a href="scripts.html"> <h1>üìÅ Scripts</h1> </a>
    <a href="scripts.html#rexplorer">rexplorer.bat</a>
    <a href="scripts.html#rmenu">ClassicRClickMenu.py</a>
    <a href="scripts.html#startads">StartAds.py</a>
    <a href="scripts.html#endtask">EndTask.py</a>
    <a href="scripts.html#localaccount">LocalAccount.py</a>
    <a href="scripts.html#dropfileremove">DropFileRemove.py</a>
    <a href="scripts.html#powerplan">PowerPlan.py</a>
    <br><br>
    <a href="foundbugs.html"><h1>üì∞ Windows Bugs</h1></a>
    <a href="foundbugs.html#filepicker">Windows Filepicker</a>
  </aside>
  <main>
    <br><br>
    <section id="rexplorer">
      <h2>rexplorer.bat</h2>
      <span class="tag">essential</span>
      <span class="tag">explorer</span>
      <span class="tag">batch</span>
      
      <p>
        A batch file that restarts explorer.exe, because sometimes restarting explorer is necessary to apply tweaks.
      </p>

      <h3>Script</h3>
      <pre><code>taskkill /im explorer.exe /f
start explorer.exe
exit</code></pre>
    </section>

    <section id="rmenu">
      <h2>ClassicRClickMenu.py</h2>
      <span class="tag">python</span>
      <span class="tag">microslop</span>
      <span class="tag">windows11</span>

      <p>
        Brings back the normal and usable Windows 10 context menu.
      </p>

      <h3>Script</h3>
      <pre><code> #Applying Windows 10 context menu
    key = winreg.CreateKey(winreg.HKEY_CURRENT_USER, path)
    winreg.SetValueEx(key, "", 0, winreg.REG_SZ, "")
    winreg.CloseKey(key)
    print("Restarting Explorer to apply changes...")
    script_dir = os.path.dirname(os.path.abspath(__file__))
    bat_file = os.path.join(script_dir, "rexplorer.bat")
    subprocess.call(bat_file)

 #Reverting back to Windows 11 context menu.
    try:
        print("Reverting to default Windows 11 right-click menu.")
        winreg.DeleteKey(winreg.HKEY_CURRENT_USER, path)
        winreg.DeleteKey(winreg.HKEY_CURRENT_USER,r"Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}")
    except FileNotFoundError:
        print("Error. Windows 11 menu is already set.")
</code></pre>

<h3>Affected directories</h3>
regedit:<pre><code>Computer\HKEY_CURRENT_USER\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32</code></pre>
    </section>

    <section id="startads">
      <h2>StartAds.py</h2>
      <span class="tag">python</span>
      <span class="tag">start-menu</span>
      <span class="tag">ads</span>

      <p>
        Removes advertisements in the start menu.
      </p>

      <h3>Script</h3>
      <pre><code> #Path
    key_path = r"Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager"
    key = winreg.OpenKey(winreg.HKEY_CURRENT_USER, key_path, 0, winreg.KEY_SET_VALUE)
 #Removing start ads
    winreg.SetValueEx(key, "SystemPaneSuggestionsEnabled", 0, winreg.REG_DWORD, 0)
 #Reverting the tweak (bringing ads back)
    winreg.SetValueEx(key, "SystemPaneSuggestionsEnabled", 0, winreg.REG_DWORD, 1)
  </code></pre>

  <h3>Affected directories</h3>
regedit:<pre><code>Computer\HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager</code></pre>
    </section>

    <section id="endtask">
  <h2>EndTask.py</h2>
  <span class="tag">python</span>
  <span class="tag">taskbar</span>
  <span class="tag">windows11</span>

  <p>
    Enables the End Task option when right-clicking an app on the Windows 11 taskbar.<br>  
    The script works by toggling an undocumented registry flag used internally
    by Windows Explorer. </p>

  <h3>Script</h3>
  <pre><code>PATH = r"Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings"
 #Applying
    key = winreg.CreateKey(winreg.HKEY_CURRENT_USER, PATH)
    winreg.SetValueEx(key, "TaskbarEndTask", 0, winreg.REG_DWORD, 1)
    winreg.CloseKey(key)
 #Reverting
    key = winreg.OpenKey(winreg.HKEY_CURRENT_USER, PATH, 0, winreg.KEY_SET_VALUE)
    winreg.DeleteValue(key, "TaskbarEndTask")
    winreg.CloseKey(key)</code></pre>
    <h3>Affected directories</h3>
regedit:<pre><code>Computer\HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings</code></pre>
    </section>
</section>

<section id="localaccount">
  <h2>LocalAccount.py</h2>
  <span class="tag">python</span>
  <span class="tag">admin</span>
  <span class="tag">windows</span>
  <span class="tag">accounts/users</span>

  <p>
    A Python script to create a new local user account. <br> You can choose to make the user an administrator or a standard account.
  </p>

  <h3>Script</h3>
  <pre><code> #Creating the account
    subprocess.run(["net", "user", username, password, "/add"], check=True)
 #Adding to Administrators (optional)
    subprocess.run(["net", "localgroup", "Administrators", username, "/add"], check=True)
    </code></pre>
</section>

<section id="dropfileremove">
  <h2>DropFileRemove.py</h2>
  <span class="tag">python</span>
  <span class="tag">explorer</span>
  <span class="tag">files</span>

  <p>
    In a <strong>recent update</strong>, Microslop added a new option for "file sharing". If you drag your file a very intrusive and annoying pop-up window will appear asking you if you want to share it to other devices. this script will remove said pop-up.
  </p>

  <h3>Script</h3>
  <pre><code>PATH = r"SYSTEM\ControlSet001\Control\FeatureManagement\Overrides\14\3895955085"
 #Applying
    key = winreg.CreateKey(winreg.HKEY_LOCAL_MACHINE, PATH)
    winreg.SetValueEx(key, "EnabledState", 0, winreg.REG_DWORD, 1)
    winreg.SetValueEx(key, "EnabledStateOptions", 0, winreg.REG_DWORD, 0)
    winreg.CloseKey(key)
 #Reverting
    key = winreg.OpenKey(
      winreg.HKEY_LOCAL_MACHINE,
      PATH,
      0,
      winreg.KEY_SET_VALUE)
    winreg.DeleteValue(key, "EnabledState")
    winreg.DeleteValue(key, "EnabledStateOptions")
    winreg.CloseKey(key)
</code></pre>

  <h3>Affected directories</h3>
  regedit:<pre><code>Computer\HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\FeatureManagement\Overrides\14\3895955085</code></pre>

</section>

<section id="powerplan">
  <h2>PowerPlan.py</h2>
  <span class="tag">python</span>
  <span class="tag">powercfg</span>
  <span class="tag">windows</span>
  <span class="tag">power-plan</span>

  <p>
    a Windows power plan manager.<br>
    You can create a custom power plan based on existing presets, some of which are normally not accessible to regular users.
  </p>

  <h3>Power Plans presets:</h3>
      <ul>
        <li>Power Saving</li>
        <li>Balanced</li>
        <li>High Performance</li>
        <li>Ultimate Performance</li>
      </ul>

  <h3>Script</h3>
  <pre><code>os.system("powercfg -duplicatescheme " + base_plan)
output = os.popen("powercfg -list").read().splitlines()
  new = ""
  for line in output:
      if base_name in line:
          new = line.split(":")[1].split("(")[0].strip()

  if new != "":
      os.system('powercfg -changename ' + new + ' "' + name + '"')
      os.system("powercfg -setactive " + new)</code></pre>

  <h3>Affected directories</h3>
  <p>
    The script does not use the Windows registry, instead it uses <code>powercfg</code> (a command-line tool).
  </p>
</section>

    <footer>
      <a> Tom√°≈° Vanƒõk 2026 - Kaspar </a>
    </footer>

  </main>

</body>
</html>
